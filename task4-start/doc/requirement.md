# 跳跳棋活动系统需求文档

![Prototype](prototype.svg)

## 1. 活动概述

---

**活动名称**：跳跳棋(Jumping Game)

**活动时间**：可配置，支持多次活动复用，管理员可灵活设置开始和结束时间

**活动用户**：所有用户

**活动目的**：提升用户送礼消耗，增加平台活跃度


## 2. 业务目标

---

- 增加用户送礼频率与金额
- 提高用户在平台的活跃时长
- 增强用户社交互动体验
- 提升主播收入与活跃度

> **📝 架构师注释**
> 
> **本次需求范围**：本次需求专注于活动本身的核心功能实现。作为一期项目，不需要建设管理后台，所有数据配置通过SQL直接初始化即可。
> 
> **其他团队**：以下功能由其他微服务负责，不在本次需求范围内：
> 
> 1. **用户服务**：用户身份验证与认证、用户信息管理和存储、用户权限控制、用户会话管理。
> 
> 2. **支付服务**：虚拟货币交易处理、支付流程管理、交易记录存储、账户余额维护、支付安全保障。
> 
> 3. **礼物服务**：礼物发送计数和记录、礼物系统管理、礼物效果触发、通过消息队列进行事件通知、礼物库存和价值管理。
> 
> 4. **奖励服务**：各类奖励的实际发放、奖励记录管理、奖励兑换处理、奖励规则执行、奖励限制控制。
> 
> 5. **通知服务**：系统消息推送、活动提醒发送、奖励通知分发、用户互动提醒、消息模板管理。
> 
> UI及交互实现由前端团队负责。


## 3. 活动规则

---

### 3.1 活动组成

活动由四个互相关联的部分组成:
1. 跳跳棋游戏 - 核心玩法
2. 宝箱兑换 - 积分奖励
3. 排行榜 - 竞争激励

用户通过赠送特定礼物参与活动，获得游戏机会和丰富奖励。

**示例场景：**
小明进入直播间，看到主播正在推广跳跳棋活动。他决定参与并送出价值100元的"彩虹糖"礼物，立即获得了10次游戏机会。通过游戏小明获得了积分，解锁了一个宝箱，并在排行榜上升到了第15名。活动期间小明每天都来参与，累计消费达到特定金额后，还获得了一个限量版的特殊奖励。

### 3.2 跳跳棋游戏

**玩法说明:**
- 游戏界面展示一条由多个格子组成的路径，通向终点"家"
- 用户每送出指定礼物达到一定金额，获得一次跳跃机会
- 用户可积累多次机会一起使用
- **每次跳跃机会相当于掷一次骰子**，骰子点数决定角色前进的步数（1-6步）
- **用户选择使用多少次跳跃机会，系统会连续掷对应次数的骰子**，累计所有骰子点数作为总前进步数
- 角色在路径上前进，停留的格子会提供不同奖励
- 到达终点时获得特别奖励，且可以重新开始游戏

**终点规则:**
- 对于单次投掷，无论点数超出多少，只要超过终点所需步数，棋子直接停在终点并获得终点奖励
- 达到终点后再次投掷，棋子会从起点重新开始
- 对于连续投掷，系统会一次一次计算，如果某次投掷导致超过终点，棋子停留在终点并获得终点奖励，下一次投掷从起点开始计算

**奖励类型:**
- 礼物道具(头像框、入场特效等)，仅可以领取一次，第二次领取积分
- 积分

**示例流程：**
用户小李送出5个"星球"礼物（每个价值20元），系统检测到他的赠送行为，自动为他增加5次游戏机会。小李决定一次性使用3次机会，**系统连续为他掷出3次骰子，点数分别为2、3、2，总计前进7步**。他的角色从起点出发，经过7步跳跃后，落在了第7号格子上。该格子包含"50积分"奖励，系统自动将奖励发放到小李的账户中。当小李累积跳跃到终点"家"时，他获得了一个特别奖励"闪亮入场特效"，并且游戏自动重置，允许他再次从起点开始。

> **📝 架构师注释**
> 
> **营销活动后端**：积分为本次需求范围，游戏格子可配置管理（默认30格），单次操作最多使用10次游戏机会，单日游戏次数限制(默认120次/天)，游戏进度注意持久化。注意现事务性保证，确保用户操作不会因系统故障导致机会丢失。
> 
> **其他团队**：礼物赠送由礼物服务负责，通过消息队列进行事件通知。UI与动画实现由前端团队负责。

### 3.3 宝箱兑换

- 用户通过跳跳棋游戏获得积分（积分可从格子中宝箱里获得）
- 积分可用于解锁不同等级的宝箱。
- 积分达到特定阈值时，对应宝箱可被解锁。
- 每个宝箱包含丰厚奖励，每个宝箱仅可兑换一次，宝箱内奖励价值随积分要求增加而提升。

**示例：**
系统设置了三级宝箱：
- 青铜宝箱：需要500积分，包含1天VIP会员
- 白银宝箱：需要2000积分，包含7天VIP会员和一个普通头像框
- 黄金宝箱：需要5000积分，包含30天VIP会员和一个限定头像框

小红通过多次参与游戏已累积了2200积分，她已经兑换了青铜宝箱，现在可以选择兑换白银宝箱。兑换后，她的积分将减少2000，剩余200积分，白银宝箱中的奖励将自动发放到她的账户。

> **📝 架构师注释**
> 
> **宝箱兑换**：所有宝箱奖励配置通过SQL直接初始化，奖励发放由奖励服务负责。

### 3.4 排行榜

- 用户积分榜: 展示活动期间获得积分最多的用户
- 排行榜前三名将获得额外奖励，激励用户竞争

**示例：**
用户积分排行榜显示：
1. 用户A：累计获得15,000积分 - 奖励"钻石王者"称号和平台币5000
2. 用户B：累计获得12,500积分 - 奖励"黄金战士"称号和平台币3000  
3. 用户C：累计获得10,800积分 - 奖励"白银勇者"称号和平台币1000

小张看到自己在积分榜上排名第五，距离第三名还有一定差距。他决定在接下来的几天中积极参与游戏，通过获取更多积分提升排名。在活动最后一天，他成功跻身前三，获得了"白银勇者"称号和额外奖励。

> **📝 架构师注释**
> 
> **排行榜**：统计以秒为单位进行更新，配置通过SQL直接初始化。用户资料获取和奖励发放由其他微服务负责。 